<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="RadioTV estudiantil interactiva de INACAP Puerto Montt. Transmisiones, concursos, postales y m√°s. ¬°Con√©ctate con El Inacapino!">
  <title>El Inacapino Puerto Montt</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    :root {
      --bg-color: #000;
      --text-color: #fff;
      --accent-color: #8000ff;
    }
    [data-theme="light"] {
      --bg-color: #fff;
      --text-color: #000;
      --accent-color: #d40000;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background-color: var(--bg-color);
      color: var(--text-color);
      font-family: sans-serif;
    }
    header {
      background-color: #111;
      padding: 10px;
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      align-items: center;
    }
    nav {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
    }
    nav a {
      color: var(--text-color);
      text-decoration: none;
      font-weight: bold;
      font-size: 14px;
    }
    .top-info {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 14px;
    }
    .live-indicator {
      background-color: red;
      color: white;
      padding: 3px 10px;
      border-radius: 20px;
      font-weight: bold;
    }
    .logo {
      max-width: 150px;
      display: block;
      margin: 20px auto;
    }
    .frase-motivacional {
      text-align: center;
      font-style: italic;
      margin-bottom: 20px;
    }
    .video-overlay-container {
      position: relative;
      width: 100%;
      max-width: 960px;
      margin: 30px auto;
    }
    .marco-overlay {
      width: 100%;
      display: block;
    }
    .video-in-marco {
      position: absolute;
      top: 11.5%;
      left: 6.3%;
      width: 87.4%;
      height: 76.2%;
      border: none;
      border-radius: 10px;
      display: none;
    }
    .vip-button, .admin-controls button, .modo-btn {
      display: block;
      margin: 10px auto;
      padding: 10px 20px;
      background-color: var(--accent-color);
      color: white;
      font-weight: bold;
      border: none;
      border-radius: 10px;
      cursor: pointer;
    }
    .login-popup {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.85);
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    .login-box {
      background: #222;
      padding: 30px;
      border-radius: 10px;
      text-align: center;
      color: white;
    }
    .login-box input {
      display: block;
      width: 80%;
      margin: 10px auto;
      padding: 8px;
      border-radius: 5px;
      border: none;
    }
    .admin-controls {
      display: none;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
    }
    @media (max-width: 768px) {
      .video-overlay-container {
        max-width: 100%;
      }
      .video-in-marco {
        top: 10.5%;
        left: 5%;
        width: 90%;
        height: 75%;
      }
    }
  </style>
</head>
<body data-theme="dark">
  <header>
    <nav>
      <a href="#">Inicio</a>
      <a href="#rebobinando">Rebobinando</a>
      <a href="#encuesta">Encuesta</a>
    </nav>
    <div class="top-info">
      <span id="reloj">00:00</span>
      <button onclick="toggleTheme()" class="modo-btn">üåì Modo D√≠a/Noche</button>
    </div>
  </header>
  <img src="radio inacap.png" alt="Logo Radio INACAP" class="logo">
  <h1 style="text-align:center;">El Inacapino Puerto Montt</h1>
  <p class="frase-motivacional" id="frase">La educaci√≥n es el pasaporte al futuro.</p>
  <div class="video-overlay-container">
    <img src="imagenes/Overlay INACAP premium.jpg" alt="Marco" class="marco-overlay">
    <iframe id="twitchPlayer" class="video-in-marco" allowfullscreen></iframe>
    <video id="player" class="video-in-marco" controls autoplay muted></video>
  </div>
  <button class="vip-button" onclick="document.getElementById('loginPopup').style.display='flex'">üéõÔ∏è Acceso VIP</button>
  <div class="login-popup" id="loginPopup">
    <div class="login-box">
      <h3>üîê Acceso VIP</h3>
      <input type="text" id="vipUser" placeholder="Usuario">
      <input type="password" id="vipPass" placeholder="Contrase√±a">
      <button onclick="verificarAcceso()">Ingresar</button>
    </div>
  </div>
  <div class="admin-controls">
    <button onclick="activarTwitch()">üî¥ Twitch</button>
    <button onclick="activarAutoDJ()">üéß AutoDJ Firebase</button>
  </div>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
    import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js";

    const firebaseConfig = {
  apiKey: "AIzaSyAu4HVlBwgVeg7kp8RwahEFdOM72JKjhKA",
  authDomain: "inacapino-radio-spark.firebaseapp.com",
  databaseURL: "https://inacapino-radio-spark-default-rtdb.firebaseio.com",
  projectId: "inacapino-radio-spark",
  storageBucket: "inacapino-radio-spark.firebasestorage.app",
  messagingSenderId: "64588373035",
  appId: "1:64588373035:web:78b92ca7b5b8b7396d1e6e"
};
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const signalRef = ref(db, 'currentSignal');

    const twitch = document.getElementById('twitchPlayer');
    const player = document.getElementById('player');

    const videos = [
      "https://firebasestorage.googleapis.com/v0/b/inacapino-radio-spark.appspot.com/o/videos%2F1%20HOUR%20MIX%20(2020).mp4?alt=media",
      "https://firebasestorage.googleapis.com/v0/b/inacapino-radio-spark.appspot.com/o/videos%2F3%20HORAS%20DE%20MUSICA%20PARA%20LIVE%202022.mp4?alt=media"
    ];
    let currentIndex = 0;

    function reproducirVideo(index) {
      player.src = videos[index];
      player.load();
      player.play();
    }

    player.addEventListener("ended", () => {
      currentIndex = (currentIndex + 1) % videos.length;
      reproducirVideo(currentIndex);
    });

    onValue(signalRef, (snapshot) => {
      const estado = snapshot.val();
      const esTwitch = estado === 'twitch';
      twitch.style.display = esTwitch ? 'block' : 'none';
      player.style.display = !esTwitch ? 'block' : 'none';
      if (!esTwitch) {
        currentIndex = 0;
        reproducirVideo(currentIndex);
      } else {
        twitch.src = "https://player.twitch.tv/?channel=xtian_alejandro&parent=sonrisitaeventos.github.io";
      }
    });

    window.activarTwitch = () => set(signalRef, 'twitch');
    window.activarAutoDJ = () => set(signalRef, 'firebase');
    window.verificarAcceso = () => {
      const user = document.getElementById('vipUser').value;
      const pass = document.getElementById('vipPass').value;
      if (user === "Inacapino" && pass === "SedePuertoMontt") {
        document.getElementById('loginPopup').style.display = 'none';
        document.querySelector('.admin-controls').style.display = 'flex';
      } else {
        alert("Usuario o contrase√±a incorrectos");
      }
    };
    window.toggleTheme = () => {
      const actual = document.body.getAttribute('data-theme');
      const nuevo = actual === 'dark' ? 'light' : 'dark';
      document.body.setAttribute('data-theme', nuevo);
      localStorage.setItem('modo', nuevo);
    };
    const fraseMotivacional = document.getElementById('frase');
    const frases = [
      "üéâLa educaci√≥n es el pasaporte al futuro.",
      "üéâCada paso cuenta, sigue avanzando.",
      "üéâEl conocimiento es poder.",
      "‚ú®Nunca dejes de aprender.",
      "üéâTu esfuerzo de hoy es tu √©xito de ma√±ana.",
      "üåüLa actitud es tan importante como la habilidad."
    ];
    let fraseActual = 0;
    setInterval(() => {
      fraseActual = (fraseActual + 1) % frases.length;
      fraseMotivacional.textContent = frases[fraseActual];
    }, 7000);
    const reloj = document.getElementById('reloj');
    setInterval(() => {
      const ahora = new Date();
      reloj.textContent = ahora.toLocaleTimeString('es-CL', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
    }, 1000);
    // Restaurar modo desde localStorage
    const modoGuardado = localStorage.getItem('modo');
    if (modoGuardado) document.body.setAttribute('data-theme', modoGuardado);
  </script>
</body>
</html>
